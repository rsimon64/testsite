<!DOCTYPE HTML>
<html>
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>CIP potato catalog</title>
<link rel="stylesheet" href="https://code.jquery.com/mobile/1.4.5/jquery.mobile-1.4.5.min.css" />
	<script src="jquery-1.4.3.min.js"></script>
	<script src="jqm-docs.js"></script>
	<script src="https://code.jquery.com/mobile/1.4.5/jquery.mobile-1.4.5.min.js"></script>

<script>

// Some sample categorized data. This data is in-memory
// for demonstration purposes, but could be loaded dynamically
// via ajax.
var categoryData = {
	varieties: {
		name: "Potato Varieties",
		description: "The Potato Catalogue contains information of 70 potato varieties selected from breeding material provided by the International Potato Center (CIP) and released by national potato program.",
		items: [
			{
				name: "CIP374080.1"
			},
			{
				name: "CIP379666.501"
			},
			{
				name: "CIP386040.9"
			}
		]
	},
	varieties: {
		name: "Potato Advanced Clones",
		description: "This catalogue is intended to provide relevant information about advanced potato clones developed at the International Potato Center (CIP). These clones are currently available for worldwide distribution to potato research programs and other interested parties, including national programs, universities, producer associations and farmer communities. The advanced clones listed in this catalogue combine several traits, such as resistance to late blight, viruses, high productivity, among others. They were selected from CIP’s breeding program and can be used to generate new varieties through further selection and validation with farmers and other chain actors according to the specific context and needs within each recipient country.",
		items: [
			{
				name: "CIP300046.22"
			},
			{
				name: "CIP300048.12"
			}
		]
	},
	countries: {
		name: "Countries of selections",
		description: "",
		items: [
			{
				name: "Peru"
			},
			{
				name: "Bangladesh"
			},
			{
				name: "Costa Rica"
			}
		]
	},
	reactions: {
		name: "Reactions to diseases",
		description: "",
		items: [
			{
				name: "medium"
			},
			{
				name: "moderately"
			}
		]
	}
};

var itemData = {
	'CIP374080.1': {
		name: "CIP374080.1",
		description: "The variety has a plant with medium vegetative period with a semi-erect growth habit with intense lilac flowers with white acumen in both surfaces; it is highly appreciated in the Altiplano of the Andes for their rounded tubers with white-cream flesh and shallow eyes; there can be process as 'chuño' and for table potato and chips (crisps). The variety was released in Peru in 1988.",
		attr: [
		  {
				name: "Tuber image",
				valu: "tuber/374080.1.jpg"
			},
			{
				name: "Plant image",
				valu: "plant/374080.1.jpg"
			},
			{
				name: "Sprout image",
				valu: "sprout/374080.1.jpg"
			},
		  {
				name: "Country of selection",
				valu: "Peru"
			},
			{
				name: "Tuber flesh predominant color",
				valu: "cream"
			},
			{
				name: "Tuber skin predominant color",
				valu: "white-cream"
			},
			{
				name: "Tuber shape",
				valu: "rounded"
			},
			{
				name: "Late Blight reaction",
				valu: "moderately resistant"
			},
			{
				name: "Growing period",
				valu: "medium"
			}
		]
	},
'CIP379666.501': {
		name: "CIP379666.501",
		description: "Is moderately resistant to late blight. It has a medium growing period, with decumbent plant habit and pale white flowers. Tubers have white flesh with an oblong shape. Heera is a table potato.",
		attr: [
		  {
				name: "Tuber image",
				valu: "tuber/379666.501.jpg"
			},
			{
				name: "Plant image",
				valu: "plant/379666.501.jpg"
			},
			{
				name: "Sprout image",
				valu: "sprout/379666.501.jpg"
			},
		  {
				name: "Country of selection",
				valu: "Bangladesh"
			},
			{
				name: "Tuber flesh color",
				valu: "white"
			},
			{
				name: "Tuber skin color",
				valu: "white-cream"
			},
			{
				name: "Resistance to Late Blight",
				valu: "moderately-resistant"
			}
		]
	},
'CIP386040.9': {
		name: "CIP386040.9",
		description: "Is a variety with moderately resistant to late blight. The plant has a medium vegetative period with decumbent plant habit; adapted to short days in cool tropical climate, the flowers are lilac with white acumen abaxial surface. The tubers are oblong with white flesh can be use as table potato. The variety was released in Guatemala as ICTA- Mercedes in 1991 and in Costa Rica as Birris in 1996.",
		attr: [
		  {
				name: "Tuber image",
				valu: "tuber/386040.9.jpg"
			},
			{
				name: "Plant image",
				valu: "plant/386040.9.jpg"
			},
			{
				name: "Sprout image",
				valu: "sprout/386040.9.jpg"
			},
		  {
				name: "Country of selection",
				valu: "Costa Rica"
			},
			{
				name: "Tuber flesh color",
				valu: "white"
			},
			{
				name: "Tuber skin color",
				valu: "white-cream"
			},
			{
				name: "Resistance to Late Blight",
				valu: "moderately resistant"
			}
		]
	}
}


function getLang(){
  var userLang = navigator.language || navigator.userLanguage;
  return(userLang)
}

// Load the data for a specific category, based on
// the URL passed in. Generate markup for the items in the
// category, inject it into an embedded page, and then make
// that page the current active page.
function showCategory( urlObj, options )
{
  //alert(getLang())
	var categoryName = urlObj.hash.replace( /.*category=/, "" ),

		// Get the object that represents the category we
		// are interested in. Note, that at this point we could
		// instead fire off an ajax request to fetch the data, but
		// for the purposes of this sample, it's already in memory.
		category = categoryData[ categoryName ],

		// The pages we use to display our content are already in
		// the DOM. The id of the page we are going to write our
		// content into is specified in the hash before the '?'.
		pageSelector = urlObj.hash.replace( /\?.*$/, "" );
    //alert(pageSelector)
    
	if ( category ) {
		// Get the page we are going to dump our content into.
		var $page = $( pageSelector ),

			// Get the header for the page.
			$header = $page.children( ":jqmData(role=header)" ),

			// Get the content area element for the page.
			$content = $page.children( ":jqmData(role=content)" ),

			// The markup we are going to inject into the content
			// area of the page.
			markup = "<p>" + category.description + "</p><ul data-role='listview' data-inset='true'>",

			// The array of items for this category.
			cItems = category.items,

			// The number of items in the category.
			numItems = cItems.length;

		// Generate a list item for each item in the category
		// and add it to our markup.
		for ( var i = 0; i < numItems; i++ ) {
			markup += "<li>" + "<a href='#items?item=" + cItems[i].name 
			+ "'>" +  cItems[i].name + "</a>"
			+ "</li>";
		}
		markup += "</ul>";

		// Find the h1 element in our header and inject the name of
		// the category into it.
		$header.find( "h1" ).html( category.name );
    
		// Inject the category items markup into the content element.
		
		$content.html( markup );

		// Pages are lazily enhanced. We call page() on the page
		// element to make sure it is always enhanced before we
		// attempt to enhance the listview markup we just injected.
		// Subsequent calls to page() are ignored since a page/widget
		// can only be enhanced once.
		$page.page();

		// Enhance the listview we just injected.
		$content.find( ":jqmData(role=listview)" ).listview();

		// We don't want the data-url of the page we just modified
		// to be the url that shows up in the browser's location field,
		// so set the dataUrl option to the URL for the category
		// we just loaded.
		options.dataUrl = urlObj.href;

		// Now call changePage() and tell it to switch to
		// the page we just modified.
		$.mobile.changePage( $page, options );
	}
}


function showItem( urlObj, options )
{
   //alert(urlObj.hash.replace( /.*item=/, "" ));
	var itemName = urlObj.hash.replace( /.*item=/, "" ),
   
		// Get the object that represents the category we
		// are interested in. Note, that at this point we could
		// instead fire off an ajax request to fetch the data, but
		// for the purposes of this sample, it's already in memory.
		item = itemData[ itemName ],

		// The pages we use to display our content are already in
		// the DOM. The id of the page we are going to write our
		// content into is specified in the hash before the '?'.
		pageSelector = urlObj.hash.replace( /\?.*$/, "" );
  //alert(pageSelector);
	if ( item ) {
		// Get the page we are going to dump our content into.
		var $page = $( pageSelector ),

			// Get the header for the page.
			$header = $page.children( ":jqmData(role=header)" ),

			// Get the content area element for the page.
			$content = $page.children( ":jqmData(role=content)" ),

			// The markup we are going to inject into the content
			// area of the page.
			markup = "<p>" + item.description + "</p><ul data-role='listview' data-inset='true'>",

			// The array of items for this category.
			cAttr = item.attr,

			// The number of items in the category.
			numAttrs = cAttr.length;

		// Generate a list item for each item in the category
		// and add it to our markup.
		for ( var i = 0; i < numAttrs; i++ ) {
		  if(cAttr[i].name.search(" image") !== -1){
		    markup += "<li><img src='" + cAttr[i].valu + "' alt='" + cAttr[i].name 
  			+ "'/></li>";
		  } else {
		  
  			markup += "<li>" + cAttr[i].name + ": <b>" + cAttr[i].valu 
  			+ "</b></li>";
		  }
		}
		markup += "</ul>";

		// Find the h1 element in our header and inject the name of
		// the category into it.
		$header.find( "h1" ).html( item.name );
		//alert(markup)

		// Inject the category items markup into the content element.
		$content.html( markup );

		// Pages are lazily enhanced. We call page() on the page
		// element to make sure it is always enhanced before we
		// attempt to enhance the listview markup we just injected.
		// Subsequent calls to page() are ignored since a page/widget
		// can only be enhanced once.
		$page.page();

		// Enhance the listview we just injected.
		$content.find( ":jqmData(role=listview)" ).listview(); // this ok? page()?

		// We don't want the data-url of the page we just modified
		// to be the url that shows up in the browser's location field,
		// so set the dataUrl option to the URL for the category
		// we just loaded.
		options.dataUrl = urlObj.href;

		// Now call changePage() and tell it to switch to
		// the page we just modified.
		$.mobile.changePage( $page, options );
	}
}


// Listen for any attempts to call changePage().
$(document).bind( "pagebeforechange", function( e, data ) {
	// We only want to handle changePage() calls where the caller is
	// asking us to load a page by URL.
	if ( typeof data.toPage === "string" ) {
		// We are being asked to load a page by URL, but we only
		// want to handle URLs that request the data for a specific
		// category.
		var u = $.mobile.path.parseUrl( data.toPage ),
			re = /^#category-item/;
		if ( u.hash.search(re) !== -1 ) {
			// We're being asked to display the items for a specific category.
			// Call our internal method that builds the content for the category
			// on the fly based on our in-memory category data structure.
			showCategory( u, data.options );

			// Make sure to tell changePage() we've handled this call so it doesn't
			// have to do anything.
			e.preventDefault();
		}
		re = /^#items/;
		if ( u.hash.search(re) !== -1 ) {
		  showItem( u, data.options );
		  e.preventDefault();
		}
	}
});


</script>
</head>

<body>
<div id="home" data-role="page">
  <div data-role="header"><h1>CIP catalog</h1></div><p><center>of potato</center></p>
  <div data-role="content">
    <!--
  	<h2>Select a Category Below:</h2>
  	-->
  	<ul data-role="listview" data-inset="true">
    	<li><a href="#category-items?category=clones">Clones</a></li>
    	
    	<li><a href="#category-items?category=varieties">Varieties</a></li>
    	<!--
    	<li><a href="#category-items?category=reactions">Reactions</a></li>
    	-->
    </ul>
  </div>

</div>
<div id="category-items" data-role="page">
  <div data-role="header"><h1></h1></div>
  <div data-role="content"></div>
</div>
<div id="items" data-role="page">
  <div data-role="header"><h1></h1></div>
  <div data-role="content"></div>
</div>
</body>
</html>

